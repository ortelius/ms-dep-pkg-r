---
name: 04 - Verify Signatures

"on":
  workflow_dispatch:
    inputs:
      image_name:
        description: "Container image name"
        required: true
      image_digest:
        description: "Image digest"
        required: true
      registry:
        description: "Container registry"
        required: true
        default: "ghcr.io"
      verify_signature:
        description: "Verify image signature"
        required: false
        default: "true"
      verify_sbom_attestation:
        description: "Verify SBOM attestation"
        required: false
        default: "true"

jobs:
  verify:
    uses: ortelius/slsa-pipeline/.github/workflows/04-verify-signatures.yml@main
    with:
      image_name: ${{ inputs.image_name }}
      image_digest: ${{ inputs.image_digest }}
      registry: ${{ inputs.registry }}
      verify_signature: ${{ inputs.verify_signature == 'true' }}
      verify_sbom_attestation: ${{ inputs.verify_sbom_attestation == 'true' }}
    secrets: inherit
